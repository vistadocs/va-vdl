// Sample JavaScript file for VA FileMan Key and Index Tutorial/******************************************************************This script is being used for the FileMan Version 22.0 Key and Index Tutorial.******************************************************************/// Start --> 1. Check if window is open<!-- Beginvar openWindowfunction setOpenWindow(current){	openWindow = current	}function closeOpenWindow() {	if (openWindow) openWindow.close()	openWindow = null	}//  End -->// Start --> 2. Create new window. Close when selected.<!-- Beginvar newWindowfunction makeNewWindow(url,windowname,parameters) {		closeOpenWindow()		newWindow = window.open(url,windowname,parameters);		setOpenWindow(newWindow)	}  function closeNewWindow() {		if (newWindow) {			newWindow.close()	}}//  End -->// Start --> 3. Open up secondardy window displaying user test results - calculate and display users score.function getScore(form,numQues,lessonNum,corrAnswers,questions,message,falseHint,constantHint) {	var currElement;	var currSelection;	var newContent = "";	var userAnswers = new Array(numQues);	var score = 0;	var numnull = 0;	var anyChecked;	var numChoi = 3;		for (i=0; i<numQues; i++) {		userAnswers[i] = "";		currElement = i*numChoi;		anyChecked = 0;				for (j=0; j<numChoi; j++) {			currSelection = form.elements[currElement + j];			if (currSelection.checked) {				anyChecked = 1;				userAnswers[i] = currSelection.value;				if (currSelection.value == corrAnswers[i])					score++;			}		}		if (anyChecked == 0)			numnull++;	}			newContent += "<TITLE>VA FileMan Version 22.0 Key and Index Tutorial - " + lessonNum + " Quiz Results</TITLE>";	newContent += "<TABLE WIDTH='100%'><TR>";newContent += "<TD ALIGN='LEFT'><FONT SIZE='2' FACE='Arial'><B>Score: " + Math.round(score/numQues*100) + "%  (You got " + score + " out of " + numQues + " correct.)</B></FONT></TD>";newContent += "<TD ALIGN='RIGHT' VALIGN='BOTTOM'><A HREF='javascript:parent.close();'><RIGHT><IMG SRC='../images/close_window_blue.gif' WIDTH='89' HEIGHT='16' BORDER='0'></RIGHT></A></TD>";newContent += "</TR></TABLE><BR>";if (numnull == numQues) {	newContent += "<TABLE WIDTH='100%'><TR><TD ALIGN='CENTER'>"; 	newContent += "<FONT SIZE='3' FACE='Arial'>" + "You did not answer any of the questions." + "</FONT>";	newContent += "</TD></TR></TABLE><BR>";	}else {	newContent += "<TABLE WIDTH='100%'><TR><TD ALIGN='CENTER'>"; 	newContent += "<FONT SIZE='3' FACE='Arial'>" + message[score] + "</FONT>";	newContent += "</TD></TR></TABLE><BR>";	}for (i=1; i<=numQues; i++) {	newContent += "<TABLE BORDER='0' WIDTH='100%'><TR>";	newContent += "<TD VALIGN='TOP' ALIGN='LEFT' WIDTH='20%'><FONT SIZE='2' FACE='Arial'>" + "<B>Question " + i + ". </B></FONT></TD>";	newContent += "<TD VALIGN='TOP' WIDTH='80%'><FONT SIZE='2' FACE='Arial'>" + questions[i-1] + "</FONT></TD></TR></TABLE>";	if (userAnswers[i-1] != "") {		if (userAnswers[i-1] != corrAnswers[i-1]) {			newContent += "<TABLE WIDTH='100%'><TR><TD VALIGN='TOP' ALIGN='LEFT' WIDTH='20%'><FONT SIZE='2' FACE='Arial'><B>></B>&nbsp<I>Your answer:</I></FONT></TD>";			newContent += "<TD VALIGN='TOP' ALIGN='LEFT' WIDTH='80%'><FONT SIZE='2' FACE='Arial' COLOR='red'>&quot;" + userAnswers[i-1] + "&quot;</FONT><I><FONT SIZE='2' FACE='Arial'>  is incorrect.</FONT></I></TD></TR>";			if (userAnswers[i-1] != "Neither of the above.") {				newContent += "<TR><TD></TD><TD><FONT SIZE='2' FACE='Arial'>" + falseHint[i-1] + "</FONT></TD></TR>";				}			newContent += "<TR><TD VALIGN='TOP' ALIGN='LEFT' WIDTH='20%'><I><FONT SIZE='2' FACE='Arial'><B>></B>&nbsp;Correct answer:</FONT></I></TD><TD VALIGN='TOP' ALIGN='LEFT' WIDTH='80%'><FONT SIZE='2' FACE='Arial' COLOR='blue'>&quot;" + corrAnswers[i-1] + "&quot;</FONT></TD></TR></TABLE>";		}		else {			newContent += "<TABLE WIDTH='100%'><TR><TD VALIGN='TOP' ALIGN='LEFT' WIDTH='20%'><FONT SIZE='2' FACE='Arial'><B>></B>&nbsp<I>Your answer</I></FONT></TD>";			newContent += "<TD VALIGN='TOP' ALIGN='LEFT' WIDTH='80%'><FONT SIZE='2' FACE='Arial' COLOR='blue'>&quot;" + corrAnswers[i-1] + "&quot;</FONT><FONT SIZE='2' FACE='Arial'><I>  is <B>correct.</FONT></I></B></TD></TR></TABLE>";			}			if (constantHint[i-1] == ""){				newContent += "<BR>";						}		if (constantHint[i-1] != ""){			newContent += "<TABLE BORDER='0' WIDTH='100%'><TR>";			newContent += "<TR><TD VALIGN='TOP' ALIGN='LEFT' WIDTH='20%'></TD><TD VALIGN='TOP' ALIGN='LEFT' WIDTH='80%'><FONT SIZE='2' FACE='Arial'>" + constantHint[i-1] + "</FONT></TD></TR></TABLE><BR>";			}		}	else {			newContent += "<TABLE WIDTH='100%'><TR><TD VALIGN='TOP' ALIGN='LEFT' WIDTH='50%'><FONT SIZE='2' FACE='Arial'><B>></B>&nbsp<I>No response from user.</I></FONT></TD><TDTD VALIGN='TOP' ALIGN='LEFT' WIDTH='0%'></TD></TR></TABLE><BR>";			}	}	makeNewWindow("","secondary","width=600,height=500,alwaysRaised=yes,scrollbars=yes,resizable=yes");	newWindow.document.write(newContent);}//  End -->